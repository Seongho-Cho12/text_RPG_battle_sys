============================================================
[PASS] tests/test_phase15_engine_attack_pipeline.py::test_phase15_engine_attack_pipeline_turn_order_indices_checks_damage
------------------------------------------------------------
[EXPERIMENT]
TITLE: 엔진 기반 공격 파이프라인 종합 검증(턴 순서 → 지수 계산 → 명중/치명 판정 → 데미지 적용)
    PURPOSE:
      - 실제 엔진(apply_steps)로 공격이 수행될 때,
        1) A1이 선턴인지(턴 순서)
        2) 지수가 요구한 공식대로 계산되는지(명중/회피/치명)
        3) 판정 결과(EVADE/WEAK/STRONG/CRITICAL)가 실제로 발생하는지
        4) 결과에 따라 데미지가 정확히 적용되는지(HP 감소)
        를 모두 확인한다.
    SETUP:
      - A1(level=10, STR=10, AGI=20) vs E1(AGI=9, WIS=6)
      - 명중 지수: 40+10=50
      - 회피 지수: (max(9,6)*2 + min(9,6))/3 = (18+6)/3=8
      - 치명 지수: level=10 → 언커먼, crit_stat="AGI" 사용
        (AGI=20, STR=10)
        weak=25 strong=35 crit=12  (기존 Phase15 테스트와 동일한 케이스)
    STEPS:
      1) 지수 계산이 기대값과 동일한지 1회 확인
      2) seed 탐색으로 4 outcome(EVADE/WEAK/STRONG/CRITICAL)을 각각 최소 1회 발생시키는 seed를 찾는다
      3) 찾은 seed로 엔진 공격을 실행해:
         - 이벤트 로그에 outcome/dmg가 남는지
         - HP가 dmg만큼 감소하는지
      4) 결과 표를 출력해 test-result 로그에서 바로 확인 가능하게 한다
    EXPECTED:
      - 4 outcome을 모두 최소 1회 관측
      - damage: EVADE=0, WEAK=1, STRONG=3, CRITICAL=9
      - 지수 계산:
        hit=50, evade=8, crit(weak,strong,critical)=(25,35,12)

[CAPTURED OUTPUT]
[Captured stdout call]

[Phase15 Engine Attack Pipeline] seeds_for_outcomes: {'EVADE': 0, 'STRONG': 1, 'WEAK': 4, 'CRITICAL': 9}
outcome | seed | indices(hit,evade,weak,strong,crit) | dmg | E1_hp_before->after
EVADE    |    0 | (50, 8, 25, 35, 12) |   0 | 50->50
   STEP: ATTACK A1->E1 outcome=EVADE dmg=0
WEAK     |    4 | (50, 8, 25, 35, 12) |   1 | 50->49
   STEP: ATTACK A1->E1 outcome=WEAK dmg=1
STRONG   |    1 | (50, 8, 25, 35, 12) |   3 | 50->47
   STEP: ATTACK A1->E1 outcome=STRONG dmg=3
CRITICAL |    9 | (50, 8, 25, 35, 12) |   9 | 50->41
   STEP: ATTACK A1->E1 outcome=CRITICAL dmg=9


