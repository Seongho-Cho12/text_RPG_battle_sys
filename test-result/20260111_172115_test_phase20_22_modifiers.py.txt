============================================================
[PASS] D:\AI_RPG\research_1\text_RPG\battle_system\tests\test_phase20_22_modifiers.py::test_phase22_apply_hp_delta_is_immediate_and_clamped
------------------------------------------------------------
[EXPERIMENT]
TITLE: APPLY_HP_DELTA가 즉시 반영되고 0 아래로 내려가면 clamp되는지 검증
    PURPOSE:
      - hp_delta는 지속형이 아니라 즉시 반영이다.
      - hp가 0 이하로 내려가면 CombatantState.hp setter가 0으로 clamp해야 한다.
    SETUP:
      - 2인 전투(A1 vs E1)
      - E1의 hp를 5로 맞춘 다음, hp_delta=-999 적용
    STEPS:
      1) E1 hp=5 설정
      2) APPLY_HP_DELTA(delta=-999) 실행
      3) E1 hp가 0인지 확인 + is_down True인지 확인
    EXPECTED:
      - hp: 5 -> 0
      - is_down: True

[CAPTURED OUTPUT]

[Phase22] HP_DELTA events:
  SLOT: MAIN used
  HP_DELTA: E1 5->0 (delta=-999)
============================================================
[PASS] tests/test_phase20_22_modifiers.py::test_phase22_apply_hp_delta_is_immediate_and_clamped
------------------------------------------------------------
[EXPERIMENT]
TITLE: APPLY_HP_DELTA가 즉시 반영되고 0 아래로 내려가면 clamp되는지 검증
        PURPOSE:
          - hp_delta는 지속형이 아니라 즉시 반영이다.
          - hp가 0 이하로 내려가면 CombatantState.hp setter가 0으로 clamp해야 한다.
        SETUP:
          - 2인 전투(A1 vs E1)
          - E1의 hp를 5로 맞춘 다음, hp_delta=-999 적용
        STEPS:
          1) E1 hp=5 설정
          2) APPLY_HP_DELTA(delta=-999) 실행
          3) E1 hp가 0인지 확인 + is_down True인지 확인
        EXPECTED:
          - hp: 5 -> 0
          - is_down: True


